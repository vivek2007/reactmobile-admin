{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Workbook = exports.Sheet = exports.Column = undefined;\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _fileSaver = require('file-saver');\n\nvar _xlsx = require('xlsx');\n\nvar _xlsx2 = _interopRequireDefault(_xlsx);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nfunction s2ab(s) {\n  var buf = new ArrayBuffer(s.length);\n  var view = new Uint8Array(buf);\n\n  for (var i = 0; i != s.length; ++i) {\n    view[i] = s.charCodeAt(i) & 0xFF;\n  }\n\n  return buf;\n}\n\nfunction datenum(v, date1904) {\n  if (date1904) v += 1462;\n  var epoch = Date.parse(v);\n  return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n}\n\nfunction sheet_from_array_of_arrays(data) {\n  var ws = {};\n  var range = {\n    s: {\n      c: 10000000,\n      r: 10000000\n    },\n    e: {\n      c: 0,\n      r: 0\n    }\n  };\n\n  for (var R = 0; R != data.length; ++R) {\n    for (var C = 0; C != data[R].length; ++C) {\n      if (range.s.r > R) range.s.r = R;\n      if (range.s.c > C) range.s.c = C;\n      if (range.e.r < R) range.e.r = R;\n      if (range.e.c < C) range.e.c = C;\n      var cell = {\n        v: data[R][C]\n      };\n      if (cell.v == null) continue;\n\n      var cell_ref = _xlsx2.default.utils.encode_cell({\n        c: C,\n        r: R\n      });\n\n      if (typeof cell.v === 'number') cell.t = 'n';else if (typeof cell.v === 'boolean') cell.t = 'b';else if (cell.v instanceof Date) {\n        cell.t = 'n';\n        cell.z = _xlsx2.default.SSF._table[14];\n        cell.v = datenum(cell.v);\n      } else cell.t = 's';\n      ws[cell_ref] = cell;\n      var dataCopyList = JSON.parse(JSON.stringify(data));\n      dataCopyList.shift();\n      ws['!cols'] = dataCopyList.map(function (dataCopy) {\n        return {\n          wpx: dataCopy.map(function (value) {\n            return String(value);\n          }).reduce(function (a, b) {\n            return a.length > b.length ? a : b;\n          }).length * 6.5 + 20\n        };\n      });\n    }\n  }\n\n  if (range.s.c < 10000000) ws['!ref'] = _xlsx2.default.utils.encode_range(range);\n  return ws;\n}\n\nvar Column = exports.Column = function (_Component) {\n  _inherits(Column, _Component);\n\n  function Column() {\n    _classCallCheck(this, Column);\n\n    return _possibleConstructorReturn(this, (Column.__proto__ || Object.getPrototypeOf(Column)).apply(this, arguments));\n  }\n\n  _createClass(Column, [{\n    key: 'render',\n    value: function render() {\n      throw new Error('<Column/> is not meant to be rendered.');\n    } // eslint-disable-line react/require-render-return\n\n  }]);\n\n  return Column;\n}(_react.Component);\n\nColumn.propTypes = {\n  label: _propTypes2.default.string.isRequired,\n  value: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]).isRequired\n};\n\nvar Sheet = exports.Sheet = function (_Component2) {\n  _inherits(Sheet, _Component2);\n\n  function Sheet() {\n    _classCallCheck(this, Sheet);\n\n    return _possibleConstructorReturn(this, (Sheet.__proto__ || Object.getPrototypeOf(Sheet)).apply(this, arguments));\n  }\n\n  _createClass(Sheet, [{\n    key: 'render',\n    value: function render() {\n      throw new Error('<Sheet/> is not meant to be rendered.');\n    } // eslint-disable-line react/require-render-return\n\n  }]);\n\n  return Sheet;\n}(_react.Component);\n\nSheet.propTypes = {\n  name: _propTypes2.default.string.isRequired,\n  data: _propTypes2.default.oneOfType([_propTypes2.default.array, _propTypes2.default.func]).isRequired,\n  children: _propTypes2.default.arrayOf(function (propValue, key) {\n    var type = propValue[key].type;\n\n    if (type !== Column) {\n      throw new Error('<Sheet> can only have <Column>\\'s as children. ');\n    }\n  }).isRequired\n};\n\nvar Workbook = exports.Workbook = function (_Component3) {\n  _inherits(Workbook, _Component3);\n\n  function Workbook(props) {\n    _classCallCheck(this, Workbook);\n\n    var _this3 = _possibleConstructorReturn(this, (Workbook.__proto__ || Object.getPrototypeOf(Workbook)).call(this, props));\n\n    _this3.download = _this3.download.bind(_this3);\n    _this3.createSheetData = _this3.createSheetData.bind(_this3);\n    return _this3;\n  }\n\n  _createClass(Workbook, [{\n    key: 'createSheetData',\n    value: function createSheetData(sheet) {\n      var columns = sheet.props.children;\n      var sheetData = [_react2.default.Children.map(columns, function (column) {\n        return column.props.label;\n      })];\n      var data = typeof sheet.props.data === 'function' ? sheet.props.data() : sheet.props.data;\n      data.forEach(function (row) {\n        var sheetRow = [];\n\n        _react2.default.Children.forEach(columns, function (column) {\n          var getValue = typeof column.props.value === 'function' ? column.props.value : function (row) {\n            return row[column.props.value];\n          };\n          sheetRow.push(getValue(row) || '');\n        });\n\n        sheetData.push(sheetRow);\n      });\n      return sheetData;\n    }\n  }, {\n    key: 'download',\n    value: function download() {\n      var _this4 = this;\n\n      if (this.props.beforeDownload !== undefined && this.props.beforeDownload !== null) {\n        this.props.beforeDownload();\n      }\n\n      var wb = {\n        SheetNames: _react2.default.Children.map(this.props.children, function (sheet) {\n          return sheet.props.name;\n        }),\n        Sheets: {}\n      };\n\n      _react2.default.Children.forEach(this.props.children, function (sheet) {\n        wb.Sheets[sheet.props.name] = sheet_from_array_of_arrays(_this4.createSheetData(sheet));\n      });\n\n      var wbout = _xlsx2.default.write(wb, {\n        bookType: 'xlsx',\n        bookSST: true,\n        type: 'binary'\n      });\n\n      (0, _fileSaver.saveAs)(new Blob([s2ab(wbout)], {\n        type: \"application/octet-stream\"\n      }), this.props.filename || 'data.xlsx');\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      return _react2.default.createElement('span', {\n        onClick: this.download\n      }, this.props.element ? this.props.element : \"Download\");\n    }\n  }]);\n\n  return Workbook;\n}(_react.Component);\n\nWorkbook.propTypes = {\n  filename: _propTypes2.default.string,\n  element: _propTypes2.default.any,\n  beforeDownload: _propTypes2.default.func,\n  children: function children(props, propName, componentName) {\n    _react2.default.Children.forEach(props[propName], function (child) {\n      if (child.type !== Sheet) {\n        throw new Error('<Workbook> can only have <Sheet>\\'s as children. ');\n      }\n    });\n  }\n};\nWorkbook.Column = Column;\nWorkbook.Sheet = Sheet;\nexports.default = Workbook;","map":null,"metadata":{},"sourceType":"script"}